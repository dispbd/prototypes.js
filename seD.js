!function(){"use strict";var t,e,i,n,o={use_api:"lampac",localhost:"http://bwa-cloud.cfhttp.top/sisi",vip_site:"",framework:""},r=new Lampa.Reguest;function l(t){return/vip.mp4/.test(t.video)}function u(t){var e,i=Lampa.Storage.get("video_quality_default","1080")+"p";if(t){for(var n in t)0==n.indexOf(i)&&(e=t[n]);e||(e=t[Lampa.Arrays.getKeys(t)[0]])}return e}function a(){clearTimeout(t),e&&(e.find("video").pause(),e.addClass("hide"),e=!1)}var s={sourceTitle:function t(e){return Lampa.Utils.capitalizeFirstLetter(e.split(".")[0])},play:function t(e){var i,n,a,s=Lampa.Controller.enabled().name;if(l(e))return i=Lampa.Storage.get("sisi_unic_id","").toLowerCase(),n=Lampa.Controller.enabled().name,a='<div class="about">\n<div>Это видео доступно с VIP подпиской. Для подключения VIP подписки, перейдите на сайт который указан ниже и укажите ваш ID</div>\n<div class="about__contacts">\n<div>\n<small>Сайт</small><br>\n'.concat(o.vip_site,"\n</div>\n\n<div>\n<small>Ваш ID</small><br>\n").concat(i,"\n</div>\n</div>\n</div>"),void Lampa.Modal.open({title:"VIP Контент",html:$(a),size:"medium",onBack:function t(){Lampa.Modal.close(),Lampa.Controller.toggle(n)}});if(e.json)Lampa.Loading.start(function(){r.clear(),Lampa.Loading.stop()}),c.account(e.video+"&json=true"),c.qualitys(e.video,function(t){var i=t.qualitys||t,n=t.recomends||[];for(var o in Lampa.Loading.stop(),i)i[o]=c.account(i[o],!0);var r={title:e.name,url:c.account(u(i),!0),url_reserve:!!t.qualitys_proxy&&c.account(u(t.qualitys_proxy),!0),quality:i};Lampa.Player.play(r),n.length?(n.forEach(function(t){t.title=Lampa.Utils.shortText(t.name,50),t.icon='<img class="size-youtube" src="'+t.picture+'" />',t.template="selectbox_icon",t.url=function(e){t.json?c.qualitys(t.video,function(i){t.quality=i.qualitys,t.url=c.account(u(i.qualitys),!0),i.qualitys_proxy&&(t.url_reserve=c.account(u(i.qualitys_proxy),!0)),e()}):(t.url=t.video,e())}}),Lampa.Player.playlist(n)):Lampa.Player.playlist([r]),Lampa.Player.callback(function(){Lampa.Controller.toggle(s)})},function(){Lampa.Noty.show(Lampa.Lang.translate("torrent_parser_nofiles"))});else{if(e.qualitys)for(var _ in e.qualitys)e.qualitys[_]=c.account(e.qualitys[_],!0);var d={title:e.name,url:c.account(u(e.qualitys)||e.video,!0),url_reserve:c.account(u(e.qualitys_proxy)||e.video_reserve||"",!0),quality:e.qualitys};Lampa.Player.play(d),Lampa.Player.playlist([d]),Lampa.Player.callback(function(){Lampa.Controller.toggle(s)})}},fixCards:function t(e){e.forEach(function(t){t.background_image=t.picture,t.poster=t.picture,t.img=t.picture,t.name=Lampa.Utils.capitalizeFirstLetter(t.name).replace(/\&(.*?);/g,"")})},isVIP:l,preview:function i(n,o){a(),t=setTimeout(function(){if(o.preview&&Lampa.Storage.field("sisi_preview")){var t=n.find("video"),i=n.find(".sisi-video-preview");t||(t=document.createElement("video"),(i=document.createElement("div")).addClass("sisi-video-preview"),i.style.position="absolute",i.style.width="100%",i.style.height="100%",i.style.left="0",i.style.top="0",i.style.overflow="hidden",i.style.borderRadius="1em",t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.left="0",t.style.top="0",t.style.objectFit="cover",i.append(t),n.find(".card__view").append(i),t.src=o.preview,t.load()),e=i,t.play(),i.removeClass("hide")}},1500)},hidePreview:a,fixList:function t(e){return e.forEach(function(t){!t.quality&&t.time&&(t.quality=t.time)}),e},menu:function t(e,i){if(i.bookmark){var n=[{title:i.bookmark.uid?"Удалить из закладок":"В закладки"}];i.related&&n.push({title:"Похожие",related:!0}),i.model&&n.push({title:i.model.name,model:!0}),Lampa.Select.show({title:"Меню",items:n,onSelect:function t(e){e.model?Lampa.Activity.push({url:o.localhost.replace("/sisi","")+"/"+i.model.uri,title:"Модель - "+i.model.name,component:"sisi_view_"+o.use_api,page:1}):e.related?Lampa.Activity.push({url:i.video+"&related=true",title:"Похожие - "+i.title,component:"sisi_view_"+o.use_api,page:1}):(c.bookmark(i,!i.bookmark.uid,function(t){Lampa.Noty.show("Успешно")}),Lampa.Controller.toggle("content"))},onBack:function t(){Lampa.Controller.toggle("content")}})}}};new function t(){var e=this,n=new Lampa.Reguest;this.menu=function(t,e){if(i)return t(i);DotNet.invokeMethodAsync("JinEnergy","sisi","").then(function(n){n?t(i=n):e(n.msg)}).catch(function(){console.log("Sisi","no load menu"),e()})},this.view=function(t,e,i){var n=this.account(Lampa.Utils.addUrlComponent(t.url,"pg="+(t.page||1)));DotNet.invokeMethodAsync("JinEnergy",n.path,n.query).then(function(t){t.list?(t.results=s.fixList(t.list),t.collection=!0,t.total_pages=t.total_pages||30,s.fixCards(t.results),delete t.list,e(t)):i()}).catch(function(){console.log("Sisi","no load",n.path+"+"+n.query),i()})},this.bookmark=function(t,e,i){i(!0)},this.account=function(t,e){if(e&&"lampac"==o.use_api&&-1==t.indexOf(o.localhost.replace("/sisi","")))return t;var i=Lampa.Storage.get("sisi_unic_id",""),n=Lampa.Storage.get("account",{}).email;return(t=-1==t.indexOf("box_mac=")?Lampa.Utils.addUrlComponent(t,"box_mac="+i):t.replace(/box_mac=[^&]+/,"box_mac="+i),n&&(t=-1==t.indexOf("account_email=")?Lampa.Utils.addUrlComponent(t,"account_email="+encodeURIComponent(n)):t.replace(/account_email=[^&]+/,"account_email="+encodeURIComponent(n))),e)?t:{path:t.split("?")[0],query:t.split("?")[1]}},this.playlist=function(t,n,o){var r=function r(){var l=new Lampa.Status(i.length);l.onComplite=function(t){var e=[];i.forEach(function(i){t[i.playlist_url]&&t[i.playlist_url].results.length&&e.push(t[i.playlist_url])}),e.length?n(e):o()},i.forEach(function(i,n){var o=e.account(i.playlist_url+t),r=!1,u=setTimeout(function(){r=!0,l.error()},8e3);DotNet.invokeMethodAsync("JinEnergy",o.path,o.query).then(function(t){clearTimeout(u),r||(t.list?(t.title=s.sourceTitle(i.title),t.results=s.fixList(t.list),t.url=i.playlist_url,t.collection=!0,t.line_type="none",t.card_events={onMenu:s.menu,onEnter:function t(e,i){s.hidePreview(),s.play(i)}},s.fixCards(t.results),delete t.list,l.append(i.playlist_url,t)):l.error())}).catch(function(){console.log("Sisi","no load",o.path+"+"+o.query),clearTimeout(u),l.error()})})};i?r():e.menu(r,o)},this.main=function(t,e,i){this.playlist("",e,i)},this.search=function(t,e,i){this.playlist("?search="+encodeURIComponent(t.query),e,i)},this.qualitys=function(t,e,i){var n=this.account(t+"&json=true");DotNet.invokeMethodAsync("JinEnergy",n.path,n.query).then(e).catch(function(t){console.log("Sisi","no load",n.path+"+"+n.query),i()})},this.clear=function(){n.clear()}};var c=new function t(){var e=this,i=new Lampa.Reguest;this.menu=function(t,e){if(n)return t(n);i.silent(this.account(o.localhost),function(i){i.channels?t(n=i.channels):e(i.msg)},e)},this.view=function(t,e,n){var o=Lampa.Utils.addUrlComponent(t.url,"pg="+(t.page||1));i.silent(this.account(o),function(t){t.list?(t.results=s.fixList(t.list),t.collection=!0,t.total_pages=t.total_pages||30,s.fixCards(t.results),delete t.list,e(t)):n()},n)},this.bookmark=function(t,e,n){var r=o.localhost+"/bookmark/"+(e?"add":"remove?uid="+t.bookmark.uid);i.silent(this.account(r),function(t){n(!0)},function(){n(!1)},JSON.stringify(t),{headers:{"Content-Type":"application/json"}})},this.account=function(t){if("lampac"==o.use_api&&-1==t.indexOf(o.localhost.replace("/sisi",""))&&"localhost"!==window.location.hostname)return t;var e=Lampa.Storage.get("sisi_unic_id",""),i=Lampa.Storage.get("account",{}).email;return t=-1==t.indexOf("box_mac=")?Lampa.Utils.addUrlComponent(t,"box_mac="+e):t.replace(/box_mac=[^&]+/,"box_mac="+e),i&&(t=-1==t.indexOf("account_email=")?Lampa.Utils.addUrlComponent(t,"account_email="+encodeURIComponent(i)):t.replace(/account_email=[^&]+/,"account_email="+encodeURIComponent(i))),t},this.playlist=function(t,o,r){var l=function l(){var u=new Lampa.Status(n.length);u.onComplite=function(t){var e=[];n.forEach(function(i){t[i.playlist_url]&&t[i.playlist_url].results.length&&e.push(t[i.playlist_url])}),e.length?o(e):r()},n.forEach(function(n){i.silent(e.account(n.playlist_url+t),function(t){t.list?(t.title=s.sourceTitle(n.title),t.results=s.fixList(t.list),t.url=n.playlist_url,t.collection=!0,t.line_type="none",t.card_events={onMenu:s.menu,onEnter:function t(e,i){s.hidePreview(),s.play(i)}},s.fixCards(t.results),delete t.list,u.append(n.playlist_url,t)):u.error()},u.error.bind(u))})};n?l():e.menu(l,r)},this.main=function(t,e,i){this.playlist("",e,i)},this.search=function(t,e,i){this.playlist("?search="+encodeURIComponent(t.query),e,i)},this.qualitys=function(t,e,n){i.silent(this.account(t+"&json=true"),e,n)},this.clear=function(){i.clear()}};function _(t){var e=new Lampa.InteractionMain(t);return e.create=function(){return this.activity.loader(!0),c.main(t,this.build.bind(this),this.empty.bind(this)),this.render()},e.empty=function(t){var e=this,i=new Lampa.Empty({descr:"string"==typeof t?t:Lampa.Lang.translate("empty_text_two")});Lampa.Activity.all().forEach(function(t){e.activity==t.activity&&t.activity.render().find(".activity__body > div")[0].appendChild(i.render(!0))}),this.start=i.start,this.activity.loader(!1),this.activity.toggle()},e.onMore=function(t){Lampa.Activity.push({url:t.url,title:t.title,component:"sisi_view_"+o.use_api,page:2})},e.onAppend=function(t,e){t.onAppend=function(t){var e=t.onFocus;t.onFocus=function(t,i){e(t,i),s.preview(t,i)}}},e}function d(t){var e,i=new Lampa.InteractionCategory(t);return i.create=function(){var i=this;this.activity.loader(!0),c.view(t,function(n){(e=n.menu)&&e.forEach(function(t){var e=t.title.split(":");t.title=e[0].trim(),e[1]&&(t.subtitle=Lampa.Utils.capitalizeFirstLetter(e[1].trim().replace(/all/i,"Любой"))),t.submenu&&t.submenu.forEach(function(t){t.title=Lampa.Utils.capitalizeFirstLetter(t.title.trim().replace(/all/i,"Любой"))})}),i.build(n),!n.results.length&&t.url.indexOf("/bookmarks")&&Lampa.Noty.show("Удерживайте ОК на видео для добавления в закладки.",{time:1e4})},this.empty.bind(this))},i.nextPageReuest=function(t,e,i){c.view(t,e.bind(this),i.bind(this))},i.cardRender=function(t,e,i){i.onMenu=function(t,e){return s.menu(t,e)},i.onEnter=function(){s.hidePreview(),s.play(e)};var n=i.onFocus;i.onFocus=function(t,i){n(t,i),s.preview(t,e)}},i.filter=function(){if(e){var n=e.filter(function(t){return!t.search_on}),r=e.find(function(t){return t.search_on});r||(r=t.search_start),(n.length||r)&&(r&&Lampa.Arrays.insert(n,0,{title:"Найти",onSelect:function t(){Lampa.Input.edit({title:"Поиск",value:"",free:!0,nosave:!0},function(t){Lampa.Controller.toggle("content"),t&&Lampa.Activity.push({url:r.playlist_url+"?search="+encodeURIComponent(t),title:"Поиск - "+t,component:"sisi_view_"+o.use_api,search_start:r,page:1})})}}),Lampa.Select.show({title:"Фильтр",items:n,onBack:function t(){Lampa.Controller.toggle("content")},onSelect:function n(r){e.forEach(function(t){t.selected=t==r}),r.submenu?Lampa.Select.show({title:r.title,items:r.submenu,onBack:function t(){i.filter()},onSelect:function e(i){Lampa.Activity.push({title:t.title,url:i.playlist_url,component:"sisi_view_"+o.use_api,page:1})}}):i.filter()}}))}},i.onRight=i.filter.bind(i),i}window["plugin_cloudsisi_"+o.use_api+"_ready"]||function t(){window["plugin_cloudsisi_"+o.use_api+"_ready"]=!0;var e=Lampa.Storage.get("sisi_unic_id","");function i(){var t,e,i,n=$('<li class="menu__item selector">\n<div class="menu__ico">\n<svg width="200" height="243" viewBox="0 0 200 243" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M187.714 130.727C206.862 90.1515 158.991 64.2019 100.983 64.2019C42.9759 64.2019 -4.33044 91.5669 10.875 130.727C26.0805 169.888 63.2501 235.469 100.983 234.997C138.716 234.526 168.566 171.303 187.714 130.727Z" stroke="currentColor" stroke-width="15"/><path d="M102.11 62.3146C109.995 39.6677 127.46 28.816 169.692 24.0979C172.514 56.1811 135.338 64.2018 102.11 62.3146Z" stroke="currentColor" stroke-width="15"/><path d="M90.8467 62.7863C90.2285 34.5178 66.0667 25.0419 31.7127 33.063C28.8904 65.1461 68.8826 62.7863 90.8467 62.7863Z" stroke="currentColor" stroke-width="15"/><path d="M100.421 58.5402C115.627 39.6677 127.447 13.7181 85.2149 9C82.3926 41.0832 83.5258 35.4214 100.421 58.5402Z" stroke="currentColor" stroke-width="15"/><rect x="39.0341" y="98.644" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="90.8467" y="92.0388" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="140.407" y="98.644" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="116.753" y="139.22" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="64.9404" y="139.22" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="93.0994" y="176.021" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/></svg>\n</div>\n<div class="menu__text">Клубничка</div>\n</li>'),r=$("<div>c</div>");r.css({position:"absolute",right:"-0.3em",bottom:"-0.5em",backgroundColor:"#fff",color:"#000",padding:"0.2em 0.4em",fontSize:"0.6em",borderRadius:"0.5em",fontWeight:900,textTransform:"uppercase"}),n.find(".menu__ico").css("position","relative").append(r),n.on("hover:enter",function(){c.menu(function(t){var e=[];("lampac"==o.use_api||Lampa.Platform.is("android"))&&e.push({title:"Все"}),t.forEach(function(t){t.title=s.sourceTitle(t.title)}),e=e.concat(t),Lampa.Select.show({title:"Сайты",items:e,onSelect:function t(e){e.playlist_url?Lampa.Activity.push({url:e.playlist_url,title:e.title,component:"sisi_view_"+o.use_api,page:1}):Lampa.Activity.push({url:"",title:"Клубничка",component:"sisi_"+o.use_api,page:1})},onBack:function t(){Lampa.Controller.toggle("menu")}})},function(){})}),$(".menu .menu__list").eq(0).append(n),(i=$('<div class="head__action head__settings selector">\n<svg height="36" viewBox="0 0 38 36" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="1.5" y="1.5" width="35" height="33" rx="1.5" stroke="currentColor" stroke-width="3"></rect>\n<rect x="7" y="8" width="24" height="3" rx="1.5" fill="currentColor"></rect>\n<rect x="7" y="16" width="24" height="3" rx="1.5" fill="currentColor"></rect>\n<rect x="7" y="25" width="24" height="3" rx="1.5" fill="currentColor"></rect>\n<circle cx="13.5" cy="17.5" r="3.5" fill="currentColor"></circle>\n<circle cx="23.5" cy="26.5" r="3.5" fill="currentColor"></circle>\n<circle cx="21.5" cy="9.5" r="3.5" fill="currentColor"></circle>\n</svg>\n</div>')).hide().on("hover:enter",function(){t&&t.activity.component().filter()}),$(".head .open--search").after(i),Lampa.Listener.follow("activity",function(n){"start"==n.type&&(t=n.object),clearTimeout(e),e=setTimeout(function(){t&&t.component!=="sisi_view_"+o.use_api&&(i.hide(),t=!1)},1e3),"start"==n.type&&n.component=="sisi_view_"+o.use_api&&(i.show(),t=n.object)}),window.sisi_add_param_ready||(window.sisi_add_param_ready=!0,Lampa.SettingsApi.addComponent({component:"sisi",name:"Клубничка",icon:'<svg width="200" height="243" viewBox="0 0 200 243" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M187.714 130.727C206.862 90.1515 158.991 64.2019 100.983 64.2019C42.9759 64.2019 -4.33044 91.5669 10.875 130.727C26.0805 169.888 63.2501 235.469 100.983 234.997C138.716 234.526 168.566 171.303 187.714 130.727Z" stroke="currentColor" stroke-width="15"/><path d="M102.11 62.3146C109.995 39.6677 127.46 28.816 169.692 24.0979C172.514 56.1811 135.338 64.2018 102.11 62.3146Z" stroke="currentColor" stroke-width="15"/><path d="M90.8467 62.7863C90.2285 34.5178 66.0667 25.0419 31.7127 33.063C28.8904 65.1461 68.8826 62.7863 90.8467 62.7863Z" stroke="currentColor" stroke-width="15"/><path d="M100.421 58.5402C115.627 39.6677 127.447 13.7181 85.2149 9C82.3926 41.0832 83.5258 35.4214 100.421 58.5402Z" stroke="currentColor" stroke-width="15"/><rect x="39.0341" y="98.644" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="90.8467" y="92.0388" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="140.407" y="98.644" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="116.753" y="139.22" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="64.9404" y="139.22" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/><rect x="93.0994" y="176.021" width="19.1481" height="30.1959" rx="9.57407" fill="currentColor"/></svg>'}),Lampa.SettingsApi.addParam({component:"sisi",param:{name:"sisi_preview",type:"trigger",values:"",default:!0},field:{name:"Предпросмотр",description:"Показывать предпросмотр при наведение на карточку"},onRender:function t(e){}}))}e||(e=Lampa.Utils.uid(8).toLowerCase(),Lampa.Storage.set("sisi_unic_id",e)),Lampa.Component.add("sisi_"+o.use_api,_),Lampa.Component.add("sisi_view_"+o.use_api,d),window.appready?i():Lampa.Listener.follow("app",function(t){"ready"==t.type&&i()})}()}();
